 <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <link rel="stylesheet" href="/output.css"/>
  <title><%= pageTitle %> -LodgeEasy</title>
  <%- include('../partials/headerIcon')%>
</head>
<body >
 
  <%- include('../partials/nav')%>
   <div class="max-w-md mx-auto mt-12 bg-white rounded-xl shadow-lg p-8">
    
      <h1 class="text-2xl font-bold text-blue-700 mb-6 text-center">Create Your Account</h1>
      
  <form action= "/signup"  method="POST"  id="signupForm" class="space-y-5">
    <% if (typeof errors !== 'undefined' && errors && errors.length > 0) { %>
      <ul style="color: red;">
      <% errors.forEach(function(error) { %>
        <li><%= error.msg %></li>
      <% }); %>
      </ul>
    <% } %>
    <input type="text" name="firstName" placeholder="First Name" required   class="w-full px-4 py-2 border border-blue-200 rounded focus:outline-none focus:ring-2 focus:ring-blue-400 transition"><br>

    <input type="text" name="lastName" placeholder="Last Name" class="w-full px-4 py-2 border border-blue-200 rounded focus:outline-none focus:ring-2 focus:ring-blue-400 transition"><br>

    <input type="text" name="city" placeholder="Enter your city" class="w-full px-4 py-2 border border-blue-200 rounded focus:outline-none focus:ring-2 focus:ring-blue-400 transition"><br>

     
    <input type="email" name="email"  id="email" placeholder="Enter your Email id" required    class="w-full px-4 py-2 border border-blue-200 rounded focus:outline-none focus:ring-2 focus:ring-blue-400 transition">

  <button type="button" id="verifyBtn"  w-full class="   w-1/2 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 rounded transition cursor-pointer shadow">Verify Email</button>
  <span id="verifyStatus"></span>
  

    <input type="password" name="password" placeholder="Enter new password" required  class="w-full px-4 py-2 border border-blue-200 rounded focus:outline-none focus:ring-2 focus:ring-blue-400 transition"><br>
    
    <label><input type="radio" name="userType" value="Guest" > <span>Guest</span></label>

  <label><input type="radio" name="userType" value="Host" ><span>Host</span></label><br>

  <input  type="checkbox"  > <label name="terms and condition"   class="w-full text-blue-700 file:mr-4 file:py-2 file:px-4 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100" ><label> I agree to the terms and condition </label><br><br>
    <input type="submit"  value="Register"  class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 rounded transition cursor-pointer shadow" >


</form>
</div>





<script>
const verifyBtn = document.getElementById("verifyBtn");
const emailInput = document.getElementById("email");
const verifyStatus = document.getElementById("verifyStatus");
const passwordBox = document.getElementById("passwordBox");

let interval;

verifyBtn.addEventListener("click", async () => {
  const email = emailInput.value;
  const res = await fetch("/signup/send-code", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ email })
  });
  const data = await res.json();
  // SHOW POPUP / MESSAGE
  alert(data.message); 
  
  if (data.success) {
    verifyStatus.innerText = " Waiting for verification...";
    verifyStatus.style.color = "blue";

    // Start polling
    interval = setInterval(async () => {
      const check = await fetch(`/signup/check-status?email=${email}`);
      console.log("NO");
      const result = await check.json();
      if (result.verified) {
        clearInterval(interval);
        verifyStatus.innerText = "Verified âœ“";
        verifyStatus.style.color = "green";
        passwordBox.style.display = "block";
      }
    }, 2000);
  }
});
</script>

</body>
</html>

